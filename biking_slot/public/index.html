<!doctype html>
<html ng-app="ubiker">
  <head>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="app.css">

    <!-- Latest compiled and minified JavaScript -->
    <!--
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    -->
  </head>
  <body ng-controller="UbikerCtrl">
    <div id="header">
      <span ng-if="isLoggedIn" class="user">Welcome, User</span>
      <button  ng-if="!isLoggedIn"  class="user btn btn-primary btn-md btn-block" data-toggle="modal" data-target="#logInModal">Log In</button>
      <h2>UB<span class="darker">ik</span>ER</h2>
    </div>
    <div class="clearfix"></div>

    <div id="controls">
      <form role="form">
        <div class="form-group">
          <label for="Slot Type">Placement Types</label>
          <select multiple class="form-control" ng-model="search.placement" placeholder="Slot Type">
            <option value="PARCEL">Parcel</option>
            <option value="SIDEWALK">Sidewalk</option>
            <option value="PARKING_LANE">Parking Lane</option>
            <option value="GARAGE">Garage</option>
          </select>
        </div>
        <button class="btn btn-primary btn-md btn-block" ng-click="updateMarkers(false)">Search</button>
      </form>
      <div class="panel panel-default">
        <div class="panel-body" ng-if="myMarkers.length>1">
          Displaying {{ myMarkers.length - 1}} parking slots  near you
        </div>
      </div>
      <div ng-if="loading" class="list-group-item">
        Finding parking slots near you
        <div class="progress progress-striped active">
          <div class="progress-bar"  role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%">
          </div>
        </div>
      </div>
    <!-- Button trigger modal -->
      <div class="list-group" ng-if="myMarkers.length>1">
        <a class="list-group-item {{ marker == selectedBikeSlot ? 'active' : '' }}" ng-repeat="marker in myMarkers" ng-if="marker.slot!==false" ng-click="setDestination(marker)">
          <h5 class="list-group-item-heading">
            {{ marker['slot'].location }}
          </h5>
          <span class="badge">{{marker['slot'].spaces}}</span>
          <!--<p class="list-group-item-text">{{ marker['slot'].distance | number:2 }} mi away </p>-->
          <p class="list-group-item-text">{{ marker['slot'].racks }} racks</p>
          <p class="list-group-item-text">Placement type: {{ marker['slot'].placement }}</p>
          <p class="list-group-item-text">Status: <span class="glyphicon glyphicon-{{ marker['slot'].status === 'COMPLETE' ? 'ok' : 'warning-sign' }}"></span></p>
          <p class="list-group-item-text" ng-if="marker['slot'].stars > 0 "><span ng-repeat="star in repeat(marker['slot'].rating) track by $index" class="glyphicon glyphicon-star"></span></p>
          <button  class="btn btn-primary btn-md btn-block" data-toggle="modal" data-target="#myModal">
          Reserve a slot 
        </button>
        </a>
      </div>
    </div>

    <div id="directions">
      <h2>Directions</h2>
      <div id="directions-panel"></div>
    </div>

    <div id="map_canvas" ui-map="myMap" ui-options="mapOptions" ui-event="{'map-idle' : 'onMapIdle()'}"></div>

    <div ng-repeat="marker in myMarkers" ui-map-marker="myMarkers[$index]['marker']" ui-event="{'map-click': 'setDestination(marker)'}"></div>

    <!-- Modal -->
    <div class="modal fade" ng-controller="UserCtrl"id="logInModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 class="modal-title" id="myModalLabel">Log In</h4>
          </div>
          <div class="modal-body">
            <div ng-if="badLogin === false">
              Wrong or inexisting username/combo, try again.
            </div>
            <form role="form" class="col-sm-6 well">
              <h3 class="text-center">Login/Sign Up</h3>
              <div class="form-group">
                <label for="email">Email address</label>
                <input ng-model="user.email" type="email" class="form-control" id="email" placeholder="Email">
              </div>
              <div class="form-group">
                <label for="password">Password</label>
                <input ng-model="user.password" type="password" class="form-control" id="password" placeholder="Password">
              </div>
              <button type="button" class="btn btn-primary" ng-click="login()">Log In</button>
            </form> 
            <form role="form" class="col-sm-6 well">
            <h3 class="text-center">Sign Up</h3>
              <div class="form-group">
                <label for="username">Username</label>
                <input type="text" class="form-control" id="username" placeholder="Username">
              </div>
              <div class="form-group">
                <label for="email">Email address</label>
                <input type="email" class="form-control" id="email" placeholder="Email">
              </div>
              <div class="form-group">
                <label for="password">Password</label>
                <input type="password" class="form-control" id="password" placeholder="Password">
              </div>
              <button type="button" class="btn btn-primary">Sign Up</button>
            </form> 
          </div>
          <div class="modal-footer">
          </div>
        </div>
      </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 class="modal-title" id="myModalLabel">Modal title</h4>
          </div>
          <div class="modal-body">
            ...
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary">Save changes</button>
          </div>
        </div>
      </div>
    </div>
    <!-- angular dependencies -->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.14/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.14/angular-resource.js"></script>
    <!-- maps -->
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>

    <!-- bootstrap dependencies -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>

    <!-- Custom files -->
    <script src="ui-map.js"></script>
    <script src="ui-event.js"></script>
    <script src="app.js"></script>

  </body>
</html>
